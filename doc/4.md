# КОМП’ЮТЕРНИЙ ПРАКТИКУМ No4

## АГРЕГАЦІЯ ТА ГРУПУВАННЯ

### Мета роботи:

Навчитися використовувати агрегатні функції `SUM()` та `AVG()` в SQL для обробки даних у базі даних PostgreSQL.

#### Варіант 9

### Хід роботи.

1. **Створення бази даних та таблиці**  
   ```sql
   CREATE DATABASE ukrainian_movies_db;
   
   \c ukrainian_movies_db
   
   CREATE TABLE ukrainian_movies (
       id SERIAL PRIMARY KEY,
       title VARCHAR(255) NOT NULL,
       director VARCHAR(255),
       genre VARCHAR(100),
       release_year INT,
       rating DECIMAL(3,1)
   );
   ```

2. **Заповнення таблиці даними**
   ```sql
   INSERT INTO ukrainian_movies (title, director, genre, release_year, rating) VALUES
   ('Тіні забутих предків', 'Сергій Параджанов', 'Драма', 1965, 8.3),
   ('Захар Беркут', 'Ахтем Сеїтаблаєв', 'Історичний', 2019, 7.1),
   ('Кіборги', 'Ахтем Сеїтаблаєв', 'Військовий', 2017, 8.0),
   ('Мої думки тихі', 'Антоніо Лукіч', 'Комедія', 2019, 7.6),
   ('Атлантида', 'Валентин Васянович', 'Драма', 2019, 7.3);
   ```

3. **Використання агрегатних функцій `SUM()` та `AVG()`**

   - Загальна сума рейтингів всіх фільмів:
     ```sql
     SELECT SUM(rating) AS total_rating FROM ukrainian_movies;
     ```
   - Середній рейтинг фільмів:
     ```sql
     SELECT AVG(rating) AS average_rating FROM ukrainian_movies;
     ```
   - Сума рейтингів по жанрах:
     ```sql
     SELECT genre, SUM(rating) AS total_rating FROM ukrainian_movies GROUP BY genre;
     ```
   - Середній рейтинг по жанрах:
     ```sql
     SELECT genre, AVG(rating) AS average_rating FROM ukrainian_movies GROUP BY genre;
     ```

### **Висновок**  

У ході виконання лабораторної роботи було здобуто практичні навички роботи з агрегатними функціями `SUM()` та `AVG()` у SQL. Було створено базу даних українських фільмів, виконано запити для підрахунку загальної суми та середнього рейтингу, а також проведено групування за жанрами. Отримані результати дозволяють ефективно аналізувати інформацію у базі даних.

